import{Ac as L,Bc as R,Cc as U,Dc as $,Fa as b,ba as p,r as i,s as S,u as c,xc as j,yc as x,zc as I}from"./chunk-QUMI2XMD.js";import{Ac as f,Qc as k,X as n,a as h,b as y,ba as l,ea as s,m as a}from"./chunk-CPQ7MZ6M.js";var E=(()=>{class o{constructor(e){this.http=e,this.skeletonLoader=!1}getOrders(e){return this.http.get(`${p.URL}/order`,{params:e})}viewOrder(e){return this.http.get(`${p.URL}/order/${e}`)}checkout(e){return this.http.post(`${p.URL}/checkout`,e)}placeOrder(e){return this.http.post(`${p.URL}/order`,e)}rePayment(e){return this.http.post(`${p.URL}/rePayment`,e)}orderTracking(e){return this.http.get(`${p.URL}/trackOrder`,{params:e})}downloadInvoice(e){let t={};return this.http.post(`${p.URL}/order/invoice`,e,{responseType:"blob"})}static{this.\u0275fac=function(t){return new(t||o)(s(f))}}static{this.\u0275prov=l({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();var d=class _{constructor(r,e,t){this.notificationService=r,this.router=e,this.orderService=t}static order(r){return r.order}static selectedOrder(r){return r.selectedOrder}static checkout(r){return r.checkout}getOrders(r,e){return this.orderService.getOrders(e?.payload).pipe(n({next:t=>{r.patchState({order:{data:t.data,total:t?.total?t?.total:t.data?.length}})},error:t=>{throw new Error(t?.error?.message)}}))}viewOrder(r,{id:e}){return this.orderService.skeletonLoader=!0,this.orderService.viewOrder(e).pipe(n({next:t=>{let m=r.getState();r.patchState(y(h({},m),{selectedOrder:t}))},error:t=>{throw new Error(t?.error?.message)},complete:()=>{this.orderService.skeletonLoader=!1}}))}checkout(r,e){return this.orderService.checkout(e?.payload).pipe(n({next:t=>{let m=r.getState();r.patchState(y(h({},m),{checkout:t}))},error:t=>{throw new Error(t?.error?.message)}}))}placeOrder(r,e){return this.orderService.placeOrder(e?.payload).pipe(n({next:t=>{(e.payload.payment_method=="cod"||e.payload.payment_method=="cash_free"||e.payload.payment_method=="sub_paisa"||e.payload.payment_method=="zyaada_pay"||e.payload.payment_method=="bank_transfer"||e.payload.payment_method=="neoKred"||e.payload.payment_method=="ease_buzz"||e.payload.payment_method=="zyaada_pay_gaj"||e.payload.payment_method=="gaj_neokred"||e.payload.payment_method=="gajlaxmi_neo2")&&!t.is_guest?this.router.navigateByUrl(`/account/order/details/${t.order_number}`):(e.payload.payment_method=="cod"||e.payload.payment_method=="cash_free"||e.payload.payment_method=="sub_paisa"||e.payload.payment_method=="zyaada_pay"||e.payload.payment_method=="bank_transfer"||e.payload.payment_method=="neoKred"||e.payload.payment_method=="ease_buzz"||e.payload.payment_method=="zyaada_pay_gaj"||e.payload.payment_method=="gaj_neokred"||e.payload.payment_method=="gajlaxmi_neo2")&&t.is_guest?this.router.navigate(["order/details"],{queryParams:{order_number:t.order_number,email_or_phone:e?.payload.email}}):window.open(t.url,"_self")},error:t=>{throw new Error(t?.error?.message)}}))}rePayment(r,e){return this.orderService.rePayment(e.payload).pipe(n({next:t=>{(e.payload.payment_method=="cod"||e.payload.payment_method=="bank_transfer"||e.payload.payment_method=="gajlaxmi_neo")&&!t.is_guest?this.router.navigateByUrl(`/account/order/details/${t.order_number}`):(e.payload.payment_method=="cod"||e.payload.payment_method=="bank_transfer"||e.payload.payment_method=="gajlaxmi_neo")&&t.is_guest?this.router.navigate(["order/details"],{queryParams:{order_number:t.order_number,email_or_phone:t.email}}):window.open(t.url,"_self")},error:t=>{throw new Error(t?.error?.message)}}))}orderTracking(r,e){return this.notificationService.notification=!1,this.orderService.orderTracking(e.payload).pipe(n({next:t=>{let m=r.getState();r.patchState(y(h({},m),{selectedOrder:t}))},error:t=>{throw new Error(t?.error?.message)}}))}downloadInvoice(r,e){return this.orderService.downloadInvoice(e.payload).pipe(n({next:t=>{let m=new Blob([t],{type:"pdf"}),w=window.URL.createObjectURL(m),O=document.createElement("a");O.href=w,O.download=`invoice-${e.payload.order_number}.pdf`,O.click(),window.URL.revokeObjectURL(w)},error:t=>{throw new Error(t?.error?.message)}}))}static{this.\u0275fac=function(e){return new(e||_)(s(b),s(k),s(E))}}static{this.\u0275prov=l({token:_,factory:_.\u0275fac})}};a([i(j)],d.prototype,"getOrders",null);a([i(x)],d.prototype,"viewOrder",null);a([i(I)],d.prototype,"checkout",null);a([i(L)],d.prototype,"placeOrder",null);a([i(R)],d.prototype,"rePayment",null);a([i(U)],d.prototype,"orderTracking",null);a([i($)],d.prototype,"downloadInvoice",null);a([c()],d,"order",null);a([c()],d,"selectedOrder",null);a([c()],d,"checkout",null);d=a([S({name:"order",defaults:{order:{data:[],total:0},selectedOrder:null,checkout:null}})],d);var P=(()=>{class o{static{this.type="[Order Status] Get"}constructor(e){this.payload=e}}return o})();var z=(()=>{class o{constructor(e){this.http=e}getOrderStatus(e){return this.http.get(`${p.URL}/orderStatus`,{params:e})}static{this.\u0275fac=function(t){return new(t||o)(s(f))}}static{this.\u0275prov=l({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();var u=class g{constructor(r){this.orderStatusService=r}static orderStatus(r){return r.orderStatus}static orderStatuses(r){return r.orderStatus.data.map(e=>({label:e?.name,value:e?.id}))}static selectedOrderStatus(r){return r.selectedOrderStatus}getOrderStatus(r,e){return this.orderStatusService.getOrderStatus(e.payload).pipe(n({next:t=>{r.patchState({orderStatus:{data:t.data,total:t?.total?t?.total:t.data?.length}})},error:t=>{throw new Error(t?.error?.message)}}))}static{this.\u0275fac=function(e){return new(e||g)(s(z))}}static{this.\u0275prov=l({token:g,factory:g.\u0275fac})}};a([i(P)],u.prototype,"getOrderStatus",null);a([c()],u,"orderStatus",null);a([c()],u,"orderStatuses",null);a([c()],u,"selectedOrderStatus",null);u=a([S({name:"orderStatus",defaults:{orderStatus:{data:[],total:0},selectedOrderStatus:null}})],u);export{E as a,d as b,P as c,u as d};
